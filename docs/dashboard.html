<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Employee Smart Roster</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/reports.css">
    <link rel="stylesheet" href="css/attendance.css">
    <link rel="stylesheet" href="css/payroll.css">
    <link rel="stylesheet" href="css/department.css">
    <!-- FullCalendar Dependencies -->
    <script src='https://cdn.jsdelivr.net/npm/@fullcalendar/core/index.global.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid/index.global.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/@fullcalendar/interaction/index.global.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/@fullcalendar/timegrid/index.global.min.js'></script>
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom JavaScript -->
    <script src="js/dashboard.js" defer></script>
    <script src="js/reports.js" defer></script>
    <script src="js/attendance.js" defer></script>
    <script src="js/payroll.js" defer></script>
    <script src="js/clinic.js" defer></script>
    <script src="js/department.js" defer></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="js/notifications.js"></script>
    <style>
        /* Sidebar collapse styles */
        .sidebar {
            height: calc(100vh - 60px);
            width: 250px;
            background-color: #fff;
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
            transition: width 0.3s ease;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Styles for collapsed sidebar */
        .sidebar.collapsed {
            width: 60px;
        }
        
        .sidebar.collapsed .nav-item {
            text-align: center;
            padding: 15px 0;
        }
        
        .sidebar.collapsed .nav-item i {
            margin-right: 0;
        }
        
        .sidebar.collapsed .nav-item span {
            display: none;
        }
        
        /* Toggle button styles */
        .sidebar-toggle {
            position: absolute;
            bottom: 20px;
            right: 10px;
            background: #f8f9fa;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 5;
            transition: all 0.3s ease;
        }
        
        .sidebar-toggle:hover {
            background: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        /* Adjust main content when sidebar is collapsed */
        .sidebar.collapsed + .main-content {
            margin-left: 60px;
        }
    </style>
</head>
<body>      
    <!-- Header -->
    <div class="header">
        <div class="logo">ShiftRoster</div>
        <div class="search-bar">
            <input type="text" placeholder="Search...">
        </div>
        <div class="header-right">
            <div class="notification-icon">
                <i class="fas fa-bell"></i>
            </div>
            <div class="profile-icon" onclick="toggleProfileModal()">
                <i class="fas fa-user"></i>
            </div>
            <div class="settings-dropdown">
                <i class="fas fa-cog" onclick="toggleDropdown()"></i>
                <div id="settingsDropdown" class="dropdown-content">
                    <a href="#"><i class="fas fa-user-cog"></i> Settings</a>
                    <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="nav-item active">
                <i class="fas fa-th-large"></i>
                <span>Dashboard</span>
            </div>
            <div class="nav-item admin-only" id="employee-management">
                <i class="fas fa-users-cog"></i>
                <span>Employee Management</span>
            </div>
            <div class="nav-item admin-only" id="department-management-nav">
                <i class="fas fa-building"></i>
                <span>Department Management</span>
            </div>
            <div class="nav-item admin-only" id="clinic-management-nav">
                <i class="fas fa-hospital"></i>
                <span>Clinic Management</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-calendar-alt"></i>
                <span>Schedule</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-calendar-check"></i>
                <span>Availability</span>
            </div>
            <div class="nav-item manager-only" id="approve-shifts-nav" onclick="window.location.href='approve-pending-shifts.html'">
                <i class="fas fa-check"></i>
                <span>Approve Shifts</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-check-circle"></i>
                <span>Attendance Rate</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-clock"></i>
                <span>Time Off</span>
            </div>
            <div class="nav-item manager-only" id="approve-timeoff-nav">
                <i class="fas fa-calendar-check"></i>
                <span>Approve Time Off</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-chart-bar"></i>
                <span>Reports</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-money-bill-wave"></i>
                <span>Payroll</span>
            </div>
            
            <!-- Add sidebar toggle button -->
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="content-header">
                <h1>Master Roster</h1>
            </div>
            
            <!-- Upcoming Shifts Section -->
            <div class="upcoming-shifts-section">
                <h2>Upcoming Shifts</h2>
                <div class="shifts-container">
                    <!-- Shifts will be added dynamically here -->
                </div>
                
                <!-- Show More Button -->
                <div class="show-more-container">
                    <button id="showMoreShifts" class="show-more-btn">
                        <span class="show-more-text">Show More</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
            </div>
            
            <!-- Calendar Section -->
            <div class="calendar-section">
                <div class="section-header">
                    <h2>Calendar</h2>
                    <!-- Add employee filter for managers/admins -->
                    <div class="calendar-filters manager-only">
                        <select id="employee-filter" class="employee-filter">
                            <option value="all">All Employees</option>
                            <!-- Will be populated dynamically -->
                        </select>
                        <select id="department-filter" class="department-filter">
                            <option value="all">All Departments</option>
                            <!-- Will be populated dynamically -->
                        </select>
                    </div>
                </div>
                <div id="calendar"></div>
            </div>

            <div class="employee-section" style="display: none;">
                <div class="section-header">
                    <h2>Employee Management</h2>
                    <button class="btn-primary" onclick="showCreateEmployeeModal()">
                        <i class="fas fa-plus"></i> Create New Employee
                    </button>
                </div>
                <div class="employee-list">
                    <table id="employeeTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Department</th>
                                <th>Clinic</th>
                                <th>Postal Code</th>
                                <th>Salary</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="employeeTableBody">
                            <!-- Employee data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Time Off Section -->
            <div class="time-off-section" style="display: none;">
                <div class="section-header">
                    <h2>Time Off</h2>
                    <button class="btn-primary" onclick="showRequestTimeOffModal()">
                        <i class="fas fa-plus"></i> Request Time Off
                    </button>
                </div>
                
                <div class="time-off-policies">
                    <h3>Time Off Policies</h3>
                    <div class="policy-cards">
                        <div class="policy-card">
                            <h4>PL</h4>
                            <p>Paid Leave</p>
                            <span class="policy-amount">10 days</span>
                        </div>
                        <div class="policy-card">
                            <h4>NPL</h4>
                            <p>Non-Paid Leave</p>
                            <span class="policy-amount">5 days</span>
                        </div>
                        <div class="policy-card">
                            <h4>MC</h4>
                            <p>Medical Certificate</p>
                            <span class="policy-amount">14 days</span>
                        </div>
                        <!-- More policy cards can be added here -->
                    </div>
                </div>
                
                <div class="request-history">
                    <h3>Request History</h3>
                    <table class="time-off-table">
                        <thead>
                            <tr>
                                <th>Date Requested</th>
                                <th>Type</th>
                                <th>From</th>
                                <th>To</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="timeOffHistoryBody">
                            <!-- Time off history will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Approve Time Off Section -->
            <div class="approve-timeoff-section" style="display: none;">
                <div class="section-header">
                    <h2>Approve Time Off Requests</h2>
                    <div class="filter-options">
                        <select id="timeoff-status-filter">
                            <option value="all">All Requests</option>
                            <option value="Pending" selected>Pending</option>
                            <option value="Approved">Approved</option>
                            <option value="Declined">Declined</option>
                        </select>
                    </div>
                </div>
                
                <div class="pending-requests">
                    <table class="time-off-table">
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th>Date Requested</th>
                                <th>Type</th>
                                <th>From</th>
                                <th>To</th>
                                <th>Reason</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pendingTimeOffBody">
                            <!-- Pending time off requests will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Availability Section -->
            <div class="availability-section" style="display: none;">
                <div class="section-header">
                    <h2>Availability Preferences</h2>
                    <button class="btn-primary" onclick="showAvailabilityPreferenceModal()">
                        <i class="fas fa-plus"></i> Set Availability
                    </button>
                </div>
                
                <div class="availability-list">
                    <table id="availabilityTable">
                        <thead>
                            <tr>
                                <th>Preferred Days</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="availabilityTableBody">
                            <!-- Availability data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Availability Preference Modal -->
            <div id="availabilityPreferenceModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeAvailabilityPreferenceModal()">&times;</span>
                    <h2>Set Availability Preferences</h2>
                    <form id="availabilityPreferenceForm">
                        <div class="form-group">
                            <label>Preferred Days</label>
                            <div class="days-checkboxes">
                                <label class="day-checkbox">
                                    <input type="checkbox" name="preferredDays" value="M"> Monday
                                </label>
                                <label class="day-checkbox">
                                    <input type="checkbox" name="preferredDays" value="T"> Tuesday
                                </label>
                                <label class="day-checkbox">
                                    <input type="checkbox" name="preferredDays" value="W"> Wednesday
                                </label>
                                <label class="day-checkbox">
                                    <input type="checkbox" name="preferredDays" value="TH"> Thursday
                                </label>
                                <label class="day-checkbox">
                                    <input type="checkbox" name="preferredDays" value="F"> Friday
                                </label>
                                <label class="day-checkbox">
                                    <input type="checkbox" name="preferredDays" value="S"> Saturday
                                </label>
                                <label class="day-checkbox">
                                    <input type="checkbox" name="preferredDays" value="SN"> Sunday
                                </label>
                            </div>
                        </div>
                        <button type="submit" class="btn-primary">Submit Availability</button>
                    </form>
                </div>
            </div>

            <!-- Schedule Section -->
            <div class="schedule-section" style="display: none;">
                <div class="section-header">
                    <h2>Schedule</h2>
                </div>
                
                <div class="schedule-tabs">
                    <div class="tab active" data-tab="my-roster">My Roster</div>
                    <div class="tab" data-tab="replacement">Replacement</div>
                </div>
                
                <div class="tab-content">
                    <!-- Roster Tab -->
                    <div class="tab-pane active" id="my-roster-tab">
                        <div id="employee-calendar"></div>
                    </div>
                    
                    <!-- Replacement Tab -->
                    <div class="tab-pane" id="replacement-tab">
                        <div class="replacement-header">
                            <h3>Shift Swap Requests</h3>
                            <button class="btn-primary" onclick="showSwapRequestModal()">
                                <i class="fas fa-exchange-alt"></i> Request Shift Swap
                            </button>
                        </div>
                        
                        <div class="swap-requests-section">
                            <div class="filter-options">
                                <select id="swap-status-filter">
                                    <option value="all">All Requests</option>
                                    <option value="pending">Pending</option>
                                    <option value="approved">Approved</option>
                                    <option value="rejected">Rejected</option>
                                </select>
                                <select id="swap-date-filter">
                                    <option value="upcoming">Upcoming</option>
                                    <option value="past">Past</option>
                                    <option value="all">All Dates</option>
                                </select>
                            </div>

                            <!-- My Swap Requests -->
                            <div class="my-swap-requests">
                                <h4>My Swap Requests</h4>
                                <div class="swap-requests-container">
                                    <table class="swap-requests-table">
                                        <thead>
                                            <tr>
                                                <th>Request Date</th>
                                                <th>My Shift</th>
                                                <th>Requested Shift</th>
                                                <th>With Employee</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="mySwapRequestsBody">
                                            <!-- Populated by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Incoming Swap Requests -->
                            <div class="incoming-swap-requests">
                                <h4>Incoming Swap Requests</h4>
                                <div class="swap-requests-container">
                                    <table class="swap-requests-table">
                                        <thead>
                                            <tr>
                                                <th>Request Date</th>
                                                <th>Requested By</th>
                                                <th>Their Shift</th>
                                                <th>Your Shift</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="incomingSwapRequestsBody">
                                            <!-- Populated by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Manager Section -->
                            <div class="manager-swap-section manager-only">
                                <h4>All Swap Requests</h4>
                                <div class="swap-requests-container">
                                    <table class="swap-requests-table">
                                        <thead>
                                            <tr>
                                                <th>Request Date</th>
                                                <th>Requester</th>
                                                <th>Original Shift</th>
                                                <th>Target Employee</th>
                                                <th>Target Shift</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="allSwapRequestsBody">
                                            <!-- Populated by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="report-section" style="display: none;">
                <div class="section-header">
                    <h2>Analytics Dashboard</h2>
                    <div class="export-buttons">
                        <button class="btn-export" id="export-pdf">
                            <i class="fas fa-file-pdf"></i> Export PDF
                        </button>
                        <button class="btn-export" id="export-csv">
                            <i class="fas fa-file-csv"></i> Export CSV
                        </button>
                    </div>
                </div>
                
                <div class="report-grid">
                    <div class="report-card performance-metrics">
                        <h3>Performance Metrics</h3>
                        <p>Track key performance indicators such as attendance consistency and task completion rates.</p>
                        <div class="chart-container">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="report-card feedback-integration">
                        <h3>Feedback Integration</h3>
                        <p>View aggregated feedback from peers and supervisors to understand employee performance qualitatively.</p>
                        <div class="chart-container">
                            <canvas id="feedbackChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="report-card managerial-insights">
                        <h3>Managerial Insights</h3>
                        <p>Analyze trends to identify top performance and areas needing more training.</p>
                        <div class="chart-container">
                            <canvas id="trendsChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="report-card goal-setting">
                        <h3>Goal Setting and Progress Tracking</h3>
                        <p>Set personal or team goals and track progress with visual indicators like progress bars.</p>
                        <div class="chart-container">
                            <canvas id="goalsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Attendance Rate Section -->
            <div class="attendance-section" style="display: none;">
                <div class="section-header">
                    <h2>Attendance Management</h2>
                    <div class="filter-options">
                        <select id="attendance-period-filter">
                            <option value="weekly">This Week</option>
                            <option value="monthly" selected>This Month</option>
                            <option value="quarterly">This Quarter</option>
                            <option value="yearly">This Year</option>
                        </select>
                    </div>
                </div>
                
                <!-- Clock In/Out Card -->
                <div class="attendance-card attendance-actions">
                    <h3>Clock In/Out</h3>
                    <div id="clock-container">
                        <div class="current-time">
                            <div id="digital-clock">00:00:00</div>
                            <div id="current-date">Loading date...</div>
                        </div>
                        <div class="clock-actions" id="clock-buttons">
                            <button id="clock-in-btn" class="btn-primary">
                                <i class="fas fa-sign-in-alt"></i> Clock In
                            </button>
                            <button id="clock-out-btn" class="btn-primary">
                                <i class="fas fa-sign-out-alt"></i> Clock Out
                            </button>
                        </div>
                        <div id="clock-status" class="status-message"></div>
                    </div>
                </div>

                <!-- Today's Schedule Card -->
                <div class="attendance-card today-schedule">
                    <h3>Today's Schedule</h3>
                    <div id="today-shifts">
                        <div class="loading-indicator">Loading your shifts...</div>
                    </div>
                </div>
                
                <!-- Attendance Rate Overview -->
                <div class="attendance-overview">
                    <div class="attendance-chart">
                                <svg viewBox="0 0 36 36" class="circular-chart">
                            <path class="circle-bg" d="M18 2.0845
                                a 15.9155 15.9155 0 0 1 0 31.831
                                a 15.9155 15.9155 0 0 1 0 -31.831" />
                            <path class="circle" stroke-dasharray="75, 100" d="M18 2.0845
                                a 15.9155 15.9155 0 0 1 0 31.831
                                a 15.9155 15.9155 0 0 1 0 -31.831" />
                            <text x="18" y="20.35" class="percentage">75%</text>
                                </svg>
                        <p class="chart-label">Attendance Rate</p>
                            </div>
                    
                        <div class="attendance-details">
                            <div class="detail-item">
                            <i class="fas fa-check-circle"></i>
                            <div class="detail-info">
                                <span class="label">On Time</span>
                                <span class="value">0</span>
                            </div>
                            </div>
                            <div class="detail-item">
                            <i class="fas fa-clock"></i>
                            <div class="detail-info">
                                <span class="label">Late</span>
                                <span class="value">0</span>
                            </div>
                            </div>
                            <div class="detail-item">
                            <i class="fas fa-times-circle"></i>
                            <div class="detail-info">
                                <span class="label">Absent</span>
                                <span class="value">0</span>
                            </div>
                            </div>
                            <div class="detail-item">
                            <i class="fas fa-calendar-minus"></i>
                            <div class="detail-info">
                                <span class="label">Leave</span>
                                <span class="value">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Total Work Hours Display -->
                    <div class="work-hours-summary">
                        <div class="hours-header">
                            <i class="fas fa-hourglass-half"></i>
                            <h4>Monthly Work Hours</h4>
                        </div>
                        <div class="hours-content">
                            <div class="hours-meter">
                                <div class="meter-bar-container">
                                    <div class="meter-bar" id="hours-meter-bar" style="width: 0%;"></div>
                                </div>
                                <div class="meter-labels">
                                    <span>0</span>
                                    <span id="hours-threshold">176 hrs</span>
                                </div>
                            </div>
                            <div class="hours-details">
                                <span id="total-work-hours">0</span>
                                <span id="hours-status" class="hours-normal">Normal</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Attendance History Table -->
                <div class="attendance-records">
                    <h3>Recent Attendance Records</h3>
                    <div class="table-container">
                        <table id="attendance-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Clock In</th>
                                    <th>Clock Out</th>
                                    <th>Status</th>
                                    <th>Total Hours</th>
                                </tr>
                            </thead>
                            <tbody id="attendance-records-body">
                                <!-- Will be populated via JavaScript -->
                                <tr>
                                    <td colspan="5" class="loading-message">Loading your attendance records...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="attendance-history">
                    <h3>Attendance History</h3>
                    <div class="chart-container attendance-chart-container">
                        <canvas id="attendanceHistoryChart"></canvas>
                    </div>
                </div>
                
                <div class="attendance-trends">
                    <div class="trend-cards">
                        <div class="trend-card">
                            <h4>Punctuality Trend</h4>
                            <div class="chart-container trend-chart-container">
                                <canvas id="punctualityChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Payroll Section -->
            <div class="payroll-section" style="display: none;">
                <div class="section-header">
                    <h2>Payroll Management</h2>
                </div>
                
                <!-- Employee Payroll View -->
                <div id="employee-payroll-view" style="display: none;">
                    <h3>My Payroll Records</h3>
                    <div class="table-container">
                        <table class="payroll-table">
                            <thead>
                                <tr>
                                    <th>Pay Period</th>
                                    <th>Base Salary</th>
                                    <th>Employee CPF</th>
                                    <th>Employer CPF</th>
                                    <th>Net Salary</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="employee-payroll-records">
                                <tr>
                                    <td colspan="7" class="loading-message">Loading your payroll records...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Admin/Manager Payroll View -->
                <div id="admin-payroll-view" style="display: none;">
                    <!-- Payroll Filters -->
                    <div class="payroll-filter">
                        <select id="payroll-month-filter">
                            <option value="all">All Months</option>
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                        
                        <select id="payroll-year-filter">
                            <option value="all">All Years</option>
                            <!-- Will be populated dynamically -->
                        </select>
                        
                        <select id="payroll-department-filter">
                            <option value="all">All Departments</option>
                            <!-- Will be populated dynamically -->
                        </select>
                    </div>
                    
                    <!-- Calculate Payroll Card -->
                    <div class="calculate-payroll-card">
                        <h3>Calculate Monthly Payroll</h3>
                        <form id="calculate-payroll-form">
                            <select id="calc-employee-id" required>
                                <option value="">Select Employee</option>
                                <!-- Will be populated dynamically -->
                            </select>
                            
                            <select id="calc-month" required>
                                <option value="">Select Month</option>
                                <option value="1">January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                            
                            <select id="calc-year" required>
                                <option value="">Select Year</option>
                                <option value="2023">2023</option>
                                <option value="2024">2024</option>
                                <option value="2025">2025</option>
                            </select>
                            
                            <button type="submit" id="calculate-btn">
                                <i class="fas fa-calculator"></i> Calculate
                            </button>
                        </form>
                        <div class="salary-note">
                            <p><i class="fas fa-info-circle"></i> Note: Each employee must have a base salary set in their profile before calculating payroll.</p>
                        </div>
                    </div>
                    
                    <!-- Payroll Statistics -->
                    <div class="payroll-stats">
                        <h3>Payroll Statistics</h3>
                        <div id="payroll-stats-container">
                            <div class="loading-message">Loading payroll statistics...</div>
                        </div>
                    </div>

                    <!-- Payroll Records Table -->
                    <h3>Payroll Records</h3>
                    <div class="table-container">
                        <table class="payroll-table">
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>Department</th>
                                    <th>Pay Period</th>
                                    <th>Base Salary</th>
                                    <th>Employee CPF</th>
                                    <th>Employer CPF</th>
                                    <th>Net Salary</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="admin-payroll-records">
                                <tr>
                                    <td colspan="8" class="loading-message">Loading payroll records...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
    <!-- Department Management Section -->
    <div class="department-management-section" style="display: none;">
        <div class="section-header">
            <h2>Department Management</h2>
            <button class="btn-primary" id="add-department-btn">
                <i class="fas fa-plus"></i> Add New Department
            </button>
        </div>
        
        <div class="departments-container">
            <div class="table-container">
                <table id="departments-table">
                    <thead>
                        <tr>
                            <th>Department Name</th>
                            <th>Description</th>
                            <th>Number of Employees</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="departments-table-body">
                        <!-- Will be populated via JavaScript -->
                        <tr>
                            <td colspan="4" class="loading-message">Loading departments data...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
    <!-- Clinic Management Section -->
    <div class="clinic-management-section" style="display: none;">
        <div class="section-header">
            <h2>Clinic Management</h2>
            <button class="btn-primary" id="add-clinic-btn">
                <i class="fas fa-plus"></i> Add New Clinic
            </button>
        </div>
        
        <div class="clinics-container">
            <div class="table-container">
                <table id="clinics-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Clinic Name</th>
                            <th>Location</th>
                            <th>Postal Code</th>
                            <th>Phone</th>
                            <th>Email</th>
                            <th>Description</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="clinics-table-body">
                        <!-- Will be populated via JavaScript -->
                        <tr>
                            <td colspan="8" class="loading-message">Loading clinics data...</td>
                        </tr>
                    </tbody>
                </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Clinic Modal -->
    <div id="add-clinic-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Add New Clinic</h2>
            <form id="add-clinic-form">
                <div class="form-group">
                    <label for="clinic-name">Clinic Name*</label>
                    <input type="text" id="clinic-name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="clinic-location">Location*</label>
                    <input type="text" id="clinic-location" name="address" required>
                </div>
                <div class="form-group">
                    <label for="clinic-postal-code">Postal Code*</label>
                    <input type="text" id="clinic-postal-code" name="postalCode" required>
                </div>
                <div class="form-group">
                    <label for="clinic-phone">Phone*</label>
                    <input type="tel" id="clinic-phone" name="phone" required>
                </div>
                <div class="form-group">
                    <label for="clinic-email">Email*</label>
                    <input type="email" id="clinic-email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="clinic-description">Description</label>
                    <textarea id="clinic-description" name="description" rows="3"></textarea>
                </div>
                <button type="submit" class="btn-primary">Add Clinic</button>
            </form>
        </div>
    </div>

    <!-- Edit Clinic Modal -->
    <div id="edit-clinic-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Edit Clinic</h2>
            <form id="edit-clinic-form">
                <input type="hidden" id="edit-clinic-id" name="clinicId">
                <div class="form-group">
                    <label for="edit-clinic-name">Clinic Name*</label>
                    <input type="text" id="edit-clinic-name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="edit-clinic-location">Location*</label>
                    <input type="text" id="edit-clinic-location" name="address" required>
                </div>
                <div class="form-group">
                    <label for="edit-clinic-postal-code">Postal Code*</label>
                    <input type="text" id="edit-clinic-postal-code" name="postalCode" required>
                </div>
                <div class="form-group">
                    <label for="edit-clinic-phone">Phone*</label>
                    <input type="tel" id="edit-clinic-phone" name="phone" required>
                </div>
                <div class="form-group">
                    <label for="edit-clinic-email">Email*</label>
                    <input type="email" id="edit-clinic-email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="edit-clinic-description">Description</label>
                    <textarea id="edit-clinic-description" name="description" rows="3"></textarea>
                </div>
                <button type="submit" class="btn-primary">Update Clinic</button>
            </form>
        </div>
    </div>

    <!-- Add Department Modal -->
    <div id="add-department-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Add New Department</h2>
            <form id="add-department-form">
                <div class="form-group">
                    <label for="department-name">Department Name*</label>
                    <input type="text" id="department-name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="department-description">Description</label>
                    <textarea id="department-description" name="description" rows="3"></textarea>
                </div>
                <button type="submit" class="btn-primary">Add Department</button>
            </form>
        </div>
    </div>

    <!-- Edit Department Modal -->
    <div id="edit-department-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Edit Department</h2>
            <form id="edit-department-form">
                <input type="hidden" id="edit-department-id" name="departmentId">
                <div class="form-group">
                    <label for="edit-department-name">Department Name*</label>
                    <input type="text" id="edit-department-name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="edit-department-description">Description</label>
                    <textarea id="edit-department-description" name="description" rows="3"></textarea>
                </div>
                <button type="submit" class="btn-primary">Update Department</button>
            </form>
        </div>
    </div>

    <!-- Create Employee Modal -->
    <div id="createEmployeeModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Create New Employee</h2>
            <form id="createEmployeeForm">
                <div class="form-group">
                    <label for="name">Full Name</label>
                    <input type="text" id="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="password">Initial Password</label>
                    <input type="password" id="password" required>
                </div>
                <div class="form-group">
                    <label for="birthday">Birthday</label>
                    <input type="date" id="birthday" required>
                </div>
                <div class="form-group">
                    <label for="gender">Gender</label>
                    <select id="gender" required>
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="role">Role</label>
                    <select id="role" required>
                        <option value="Employee">Employee</option>
                        <option value="Manager">Manager</option>
                        <option value="Admin">Admin</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="department">Department</label>
                    <select id="department">
                        <option value="">Select Department</option>
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="postalCode">Postal Code</label>
                    <input type="text" id="postalCode" required>
                </div>
                <div class="form-group">
                    <label for="baseSalary">Base Salary</label>
                    <input type="number" id="baseSalary" step="0.01" min="0">
                </div>
                <button type="submit" class="btn-primary">Create Employee</button>
            </form>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeProfileModal()">&times;</span>
            <h2>Personal Information</h2>
            <div class="profile-info">
                <div class="profile-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="profile-details">
                    <div class="info-row">
                        <span class="info-label">Name:</span>
                        <span id="profile-name" class="info-value">Loading...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Email:</span>
                        <span id="profile-email" class="info-value">Loading...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Role:</span>
                        <span id="profile-role" class="info-value">Loading...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Department:</span>
                        <span id="profile-department" class="info-value">Loading...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Birthday:</span>
                        <span id="profile-birthday" class="info-value">Loading...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Gender:</span>
                        <span id="profile-gender" class="info-value">Loading...</span>
                    </div>
                </div>
            </div>
            <div class="profile-actions">
                <button class="btn-primary" onclick="showEditProfileModal()">
                    <i class="fas fa-edit"></i> Edit Profile
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="editProfileModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditProfileModal()">&times;</span>
            <h2>Edit Profile</h2>
            <form id="editProfileForm">
                <div class="form-group">
                    <label for="edit-name">Full Name</label>
                    <input type="text" id="edit-name" required>
                </div>
                <div class="form-group">
                    <label for="edit-email">Email</label>
                    <input type="email" id="edit-email" required readonly class="readonly-field">
                </div>
                <div class="form-group">
                    <label for="edit-department">Department</label>
                    <input type="text" id="edit-department" readonly class="readonly-field">
                </div>
                <div class="form-group">
                    <label for="edit-birthday">Birthday</label>
                    <input type="date" id="edit-birthday" required>
                </div>
                <div class="form-group">
                    <label for="edit-gender">Gender</label>
                    <select id="edit-gender" required>
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <button type="submit" class="btn-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Edit Shift Modal -->
    <div id="editShiftModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditShiftModal()">&times;</span>
            <h2>Edit Shift</h2>
            <form id="editShiftForm">
                <div class="form-group">
                    <label for="edit-shift-title">Shift Title</label>
                    <input type="text" id="edit-shift-title" required>
                </div>
                <div class="form-row">
                    <div class="form-group half-width">
                        <label for="edit-shift-start-date">Start Date</label>
                        <input type="date" id="edit-shift-start-date" required>
                    </div>
                    <div class="form-group half-width">
                        <label for="edit-shift-start-time">Start Time</label>
                        <input type="time" id="edit-shift-start-time" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group half-width">
                        <label for="edit-shift-end-date">End Date</label>
                        <input type="date" id="edit-shift-end-date" required>
                    </div>
                    <div class="form-group half-width">
                        <label for="edit-shift-end-time">End Time</label>
                        <input type="time" id="edit-shift-end-time" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="edit-shift-status">Status</label>
                    <select id="edit-shift-status" required>
                        <option value="Pending">Pending</option>
                        <option value="Confirmed">Confirmed</option>
                        <option value="Completed">Completed</option>
                        <option value="Cancelled">Cancelled</option>
                    </select>
                </div>
                <input type="hidden" id="edit-shift-id">
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Save Changes</button>
                    <button type="button" class="btn-danger" onclick="deleteShift()">Delete Shift</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Shift Modal -->
    <div id="addShiftModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAddShiftModal()">&times;</span>
            <h2>Add New Shift</h2>
            <form id="addShiftForm">
                <div class="form-group">
                    <label for="add-shift-title">Shift Title</label>
                    <input type="text" id="add-shift-title" required>
                </div>
                <div class="form-row">
                    <div class="form-group half-width">
                        <label for="add-shift-start-date">Start Date</label>
                        <input type="date" id="add-shift-start-date" required>
                    </div>
                    <div class="form-group half-width">
                        <label for="add-shift-start-time">Start Time</label>
                        <input type="time" id="add-shift-start-time" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group half-width">
                        <label for="add-shift-end-date">End Date</label>
                        <input type="date" id="add-shift-end-date" required>
                    </div>
                    <div class="form-group half-width">
                        <label for="add-shift-end-time">End Time</label>
                        <input type="time" id="add-shift-end-time" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="add-shift-status">Status</label>
                    <select id="add-shift-status" required>
                        <option value="Pending">Pending</option>
                        <option value="Confirmed">Confirmed</option>
                    </select>
                </div>
                <button type="submit" class="btn-primary">Add Shift</button>
            </form>
        </div>
    </div>

    <!-- Request Time Off Modal -->
    <div id="requestTimeOffModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeRequestTimeOffModal()">&times;</span>
            <h2>New Time Off Request</h2>
            <form id="requestTimeOffForm">
                <div class="form-group">
                    <label for="time-off-policy">Time Off Policy</label>
                    <select id="time-off-policy" required>
                        <option value="">Select Type</option>
                        <option value="Paid">Paid Leave (PL)</option>
                        <option value="Unpaid">Non-Paid Leave (NPL)</option>
                        <option value="Medical">Medical Certificate (MC)</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group half-width">
                        <label for="time-off-start-date">Start Date</label>
                        <input type="date" id="time-off-start-date" required>
                    </div>
                    <div class="form-group half-width">
                        <label for="time-off-end-date">End Date</label>
                        <input type="date" id="time-off-end-date" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="time-off-notes">Additional Notes</label>
                    <textarea id="time-off-notes" rows="4"></textarea>
                </div>
                <button type="submit" class="btn-primary">Submit Request</button>
            </form>
        </div>
    </div>

    <!-- Time Off Request Details Modal (Manager View) -->
    <div id="timeOffDetailsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeTimeOffDetailsModal()">&times;</span>
            <h2>Time Off Request</h2>
            <div class="employee-info">
                <h3 id="request-employee-name">Employee Name</h3>
            </div>
            <div class="request-details" id="request-details-container">
                <!-- Request details will be populated here -->
            </div>
            <div class="form-actions manager-actions">
                <button type="button" class="btn-primary" onclick="approveTimeOff()">Accept</button>
                <button type="button" class="btn-danger" onclick="rejectTimeOff()">Reject</button>
            </div>
        </div>
    </div>

    <!-- Add this new modal for shift swap requests -->
    <div id="swapRequestModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSwapRequestModal()">&times;</span>
            <h2>Request Shift Swap</h2>
            <form id="swapRequestForm">
                <div class="form-group">
                    <label for="my-shift">My Shift</label>
                    <select id="my-shift" required>
                        <option value="">Select your shift</option>
                        <!-- Populated by JavaScript -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="target-employee">Target Employee</label>
                    <select id="target-employee" required>
                        <option value="">Select employee</option>
                        <!-- Populated by JavaScript -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="target-shift">Target Shift</label>
                    <select id="target-shift" required disabled>
                        <option value="">Select target shift</option>
                        <!-- Populated by JavaScript -->
                    </select>
                </div>
                
                <button type="submit" class="btn-primary">Submit Request</button>
            </form>
        </div>
    </div>

    <script>
        // Add this at the end of the file, just before the closing </body> tag
        document.addEventListener('DOMContentLoaded', function() {
            // Add event listener for sidebar toggle
            document.getElementById('sidebarToggle').addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.toggle('collapsed');
                
                // Change the icon based on sidebar state
                const icon = this.querySelector('i');
                if (sidebar.classList.contains('collapsed')) {
                    icon.classList.remove('fa-chevron-left');
                    icon.classList.add('fa-chevron-right');
                } else {
                    icon.classList.remove('fa-chevron-right');
                    icon.classList.add('fa-chevron-left');
                }
                
                // Save preference to localStorage
                localStorage.setItem('sidebarCollapsed', sidebar.classList.contains('collapsed'));
            });
            
            // Check if sidebar was collapsed previously
            if (localStorage.getItem('sidebarCollapsed') === 'true') {
                const sidebar = document.getElementById('sidebar');
                const toggleIcon = document.querySelector('#sidebarToggle i');
                
                sidebar.classList.add('collapsed');
                toggleIcon.classList.remove('fa-chevron-left');
                toggleIcon.classList.add('fa-chevron-right');
            }
            
            // Set up event listeners for sidebar navigation
            document.querySelector('.nav-item:has(i.fa-clock)').addEventListener('click', showTimeOffSection);
            // Add event listener for Approve Time Off section
            document.getElementById('approve-timeoff-nav').addEventListener('click', showApproveTimeOffSection);
            // Add event listener for Availability section
            document.querySelector('.nav-item:has(i.fa-calendar-check)').addEventListener('click', showAvailabilitySection);
            
            // Add event listener for show more button
            const showMoreBtn = document.getElementById('showMoreShifts');
            if (showMoreBtn) {
                showMoreBtn.addEventListener('click', function() {
                    const shiftsContainer = document.querySelector('.shifts-container');
                    const buttonText = this.querySelector('.show-more-text');
                    
                    shiftsContainer.classList.toggle('expanded');
                    this.classList.toggle('expanded');
                    
                    if (shiftsContainer.classList.contains('expanded')) {
                        buttonText.textContent = 'Show Less';
                    } else {
                        buttonText.textContent = 'Show More';
                    }
                });
            }
        });
    </script>
</body>
</html> 